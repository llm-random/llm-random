parent: configs/baselines/gpt/dense/medium.yaml
md5_parent_hash: 1706dd43c527be74a6282b0319e9c31e
time: 0-2:00:00
interactive_debug_session: false
interactive_debug: false

params:
  name: "local_search_medium_relative_lr"

  batch_size: 512
  cutoff: 256

  n_steps: 8_000
  final_lr_step: 8_000
  lr_warmup_steps: 80
  scheduler: cosine
  init_type: truncated_normal
  effective_dff_x: 4

  learning_rate: 0.003
  weight_decay: 0.225
  final_lr_fraction: 0.04444
  init_scale: 0.5

  save_weights_interval: 0
  mixed_precision: True
  mixed_precision_dtype: bfloat16
  loss_checkpoint_chungs: 4

  relative_lr:
    embedding_layer: 1
    head: 1

  relative_init_scale:
    embedding_layer: 1
    head: 1

tune_config:
  iters: 30
  tune_params:
    - "learning_rate"
    #- "weight_decay"
    #- "final_lr_fraction"
    - "init_scale"
    - "relative_lr:embedding_layer"
    - "relative_lr:head"
    - "relative_init_scale:embedding_layer"
    - "relative_init_scale:head"
