params:

  activation_checkpointing_modules: EmbeddingLayer,PredictionHead,TransformerBlock
  all_config_paths: configs/baselines/common.yaml,configs/baselines/gpt/dense/base.yaml,configs/baselines/gpt/dense/common.yaml,configs/experiments/relative_lr/large_dense.yaml
  batch_size: 384
  common_directory: /home/jkrajewski_a100
  cpus_per_gpu: 8
  cutoff: 1024
  dataset_type: c4
  dff: 3072
  dmodel: 1536
  ff_mode: swi_glu
  final_lr_fraction: 0.066666
  final_lr_step: 50000
  flash_attention: true
  fsdp_enabled: true
  fsdp_modules_to_wrap: EmbeddingLayer,PredictionHead,TransformerBlock
  fsdp_selective_precision_modules: AttentionMechanism
  git_branch: dense_large_2024-09-02_12-18-15
  grad_clip: 0.1
  gres: gpu:1
  grid_entrypoint: lizrd/grid/grid_entrypoint.sh
  hf_datasets_cache: /local_storage_2/dataset_cache
  init_scale: 0.333
  init_type: truncated_normal
  interactive_debug: false
  interactive_debug_session: false
  learning_rate: 5e-4
  logger_types: neptune
  logging_interval_heavy: 5000
  logging_interval_loss: 1000
  loss_checkpoint_chungs: 8
  lr_warmup_steps: 500
  md5_parent_hash: 763f39978a58f704200275285162594c
  mem_per_gpu: 125
  mixed_precision: true
  mixed_precision_dtype: bfloat16
  model_type: gpt
  n_att_heads: 12
  n_blocks: 24
  n_gpus: 8
  n_steps: 50000
  name: dense_large
  nodelist: null
  parent: configs/baselines/gpt/dense/base.yaml
  path_to_entry_config: configs/experiments/relative_lr/large_dense.yaml
  print_parameter_names: true
  project_name: pmtest/llm-random
  relative_lr:
    embedding_layer: 5.0
    head: 1.0
    layer.feedforward: 1.0
    projection: 1.0
  relative_scheduler_fraction:
    embedding_layer: 0.6666
    head: 0.4444
    layer.feedforward: 0.6666
    projection: 0.2
  runner: research.conditional.train.cc_train
  runs_multiplier: 1
  save_weights_interval: 0
  save_weights_path: model_ckpt
  scheduler: cosine
  singularity_image: /home/jkrajewski_a100/images/sparsity_2024.02.06_16.14.02.sif
  tags:
  - relative
  - compute_opt
  - large_extrapolation
  - dense
  - seq_len_1024
  time: '90:00:00'
  train_dataset_path: /local_storage_2/llm-random/datasets/c4_train
  validation_dataset_path: /local_storage_2/llm-random/datasets/c4_validation
  weight_decay: 0.15